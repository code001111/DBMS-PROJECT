<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop - TechStore</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.svg') }}" type="image/svg+xml">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">ðŸ›’ TechStore</div>
            <div class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/shop" class="nav-link active">Shop</a>
                <a href="/cart" class="nav-link">Cart</a>
                <a href="/orders" class="nav-link">Orders</a>
            </div>
            <div class="cart-icon">
                <span id="cart-count">0</span>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1>Our Products</h1>
        
        <div id="products-list" class="products-grid">
            <!-- Products will be loaded here -->
        </div>
    </div>

    <footer>
        <p>&copy; 2025 TechStore. All rights reserved.</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        // Load products when page loads
        document.addEventListener('DOMContentLoaded', loadProducts);

        async function loadProducts() {
            try {
                const response = await fetch('/api/products');
                const products = await response.json();
                
                const productsList = document.getElementById('products-list');
                productsList.innerHTML = '';
                
                products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <div class="product-image">
                            ${product.image_url ? `<img src="${product.image_url}" alt="${product.product_name}">` : 'ðŸ“±'}
                        </div>
                        <h3>${product.product_name}</h3>
                        <p class="description">${product.description}</p>
                        <p class="price">â‚¹${product.price.toFixed(2)}</p>
                        <p class="stock">Stock: ${product.quantity_available}</p>
                        <div class="quantity-selector">
                            <input type="number" min="1" max="${product.quantity_available}" value="1" class="qty-input" id="qty-${product.product_id}">
                        </div>
                        <button class="btn btn-primary" onclick="addToCart(${product.product_id})">Add to Cart</button>
                    `;
                    productsList.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading products:', error);
                document.getElementById('products-list').innerHTML = '<p>Error loading products</p>';
            }
        }

        function addToCart(productId) {
            const quantity = parseInt(document.getElementById(`qty-${productId}`).value);
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            
            const existingItem = cart.find(item => item.product_id === productId);
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({ product_id: productId, quantity });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            alert('Product added to cart!');
        }
    </script>
</body>
</html>
